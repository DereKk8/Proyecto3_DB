CREATE OR REPLACE TRIGGER DESCUENTO
BEFORE INSERT OR UPDATE ON DETALLEPEDIDOS FOR EACH ROW
DECLARE 
DESCUENT NUMBER;
PRECIOUNIDAD NUMBER;
BEGIN
SELECT GAMASPRODUCTOS.DESCUENTO INTO DESCUENT
FROM PRODUCTOS
INNER JOIN GAMASPRODUCTOS
ON PRODUCTOS.GAMA = GAMASPRODUCTOS.GAMA
WHERE PRODUCTOS.CODIGOPRODUCTO =: NEW.CODIGOPRODUCTO;

SELECT PRECIOUNIDAD INTO PRECIOUNIDAD
FROM DETALLEPEDIDOS
INNER JOIN PRODUCTOS
ON DETALLEPEDIDOS.CODIGOPRODUCTO = PRODUCTOS.CODIGOPRODUCTO;

IF DESCUENT IS NOT NULL THEN
:NEW.PRECIOUNIDAD := PRECIOUNIDAD *(DESCUENT / 100);
END IF;

END;
/
