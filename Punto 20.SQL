CREATE OR REPLACE TRIGGER ACTUALIZAR_STOCK
BEFORE INSERT OR UPDATE ON DETALLEPEDIDOS FOR EACH ROW
DECLARE
PEDIDO NUMBER;
CODIGO VARCHAR2(15 BYTE);
BEGIN 
SELECT GM.CANTIDAD INTO PEDIDO
FROM DETALLEPEDIDOS GM
JOIN PRODUCTOS P ON P.CODIGOPRODUCTO = GM.CODIGOPRODUCTO;

SELECT GM.CODIGOPRODUCTO INTO CODIGO
FROM DETALLEPEDIDOS GM;


UPDATE PRODUCTOS 
SET CANTIDADENSTOCK = CANTIDADENSTOCK -PEDIDO
WHERE CODIGOPRODUCTO = CODIGO;
    
END;
/
