CREATE OR REPLACE FUNCTION PRODUCTO_MAS_VENDIDO
RETURN NUMBER
IS
VALORMAX NUMBER:=0;

BEGIN

SELECT B.CODIGO, B.MAXIMO, DETALLEPEDIDOS.PRECIOUNIDAD INTO VALORMAX
FROM
(SELECT A.CODIGO, MAX(A.CANTIDAD) AS MAXIMO
FROM
(SELECT CODIGOPRODUCTO AS CODIGO, SUM(CANTIDAD) AS CANTIDAD
FROM DETALLEPEDIDOS
GROUP BY CODIGOPRODUCTO) A
GROUP BY A.CODIGO
)B
INNER JOIN DETALLEPEDIDOS
ON B.CODIGO =DETALLEPEDIDOS.CODIGOPRODUCTO
ORDER BY B.MAXIMO DESC
 FETCH FIRST 1 ROW ONLY;
 
 RETURN VALORMAX;
 
 END;
